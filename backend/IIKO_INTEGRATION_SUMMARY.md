# –°–≤–æ–¥–∫–∞ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å iiko API

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å (`IikoService`)
- **–§–∞–π–ª**: `app/Services/IikoService.php`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–∞ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
  - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ–Ω—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –º–µ–Ω—é —Å —Ü–µ–Ω–∞–º–∏
  - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ü–µ–Ω
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–Ω—é

### 2. API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (`IikoController`)
- **–§–∞–π–ª**: `app/Http/Controllers/Api/IikoController.php`
- **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
  - `GET /api/iiko/test-connection` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  - `GET /api/iiko/organizations` - —Å–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
  - `GET /api/iiko/menu` - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ–Ω—é
  - `GET /api/iiko/external-menu` - –≤–Ω–µ—à–Ω–µ–µ –º–µ–Ω—é —Å —Ü–µ–Ω–∞–º–∏
  - `GET /api/iiko/price-categories` - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ü–µ–Ω
  - `POST /api/iiko/sync-menu` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–Ω—é

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–§–∞–π–ª**: `config/services.php`
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
  - `IIKO_API_KEY` - –≤–∞—à API –∫–ª—é—á
  - `IIKO_BASE_URL` - –±–∞–∑–æ–≤—ã–π URL API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: https://api-ru.iiko.services)

### 4. Artisan –∫–æ–º–∞–Ω–¥—ã
- **–§–∞–π–ª**: `app/Console/Commands/TestIikoConnection.php`
  - –ö–æ–º–∞–Ω–¥–∞: `php artisan iiko:test-connection`
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

- **–§–∞–π–ª**: `app/Console/Commands/SyncIikoMenu.php`
  - –ö–æ–º–∞–Ω–¥–∞: `php artisan iiko:sync-menu [organization_id]`
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –º–µ–Ω—é –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

### 5. –¢–µ—Å—Ç—ã
- **–§–∞–π–ª**: `tests/Feature/IikoServiceTest.php`
- **–ü–æ–∫—Ä—ã—Ç–∏–µ**: –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Å–µ—Ä–≤–∏—Å–∞ —Å –º–æ–∫–∞–º–∏

### 6. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `IIKO_INTEGRATION_SETUP.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- `IIKO_USAGE_EXAMPLES.md` - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `IIKO_INTEGRATION_SUMMARY.md` - —ç—Ç–∞ —Å–≤–æ–¥–∫–∞

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ .env —Ñ–∞–π–ª
IIKO_API_KEY=e443a1d8f6f941eba3d92fbed30bdefd
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
php artisan iiko:test-connection

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–Ω—é
php artisan iiko:sync-menu
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ
```php
use App\Services\IikoService;

// –í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–µ
$iikoService = app(IikoService::class);
$organizations = $iikoService->getOrganizations();
$menu = $iikoService->getExternalMenu($organizationId);
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç API –∫–ª—é—á –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–∞
- –¢–æ–∫–µ–Ω –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 50 –º–∏–Ω—É—Ç (—Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ 1 —á–∞—Å)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `storage/logs/laravel.log`
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å —Ñ–ª–∞–≥–æ–º `success`
- Graceful handling –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- API –∫–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∑–∞—â–∏—â–µ–Ω—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–æ–≤

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
```json
[
  {
    "id": "uuid",
    "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏",
    "type": "restaurant"
  }
]
```

### –ú–µ–Ω—é
```json
{
  "groups": [
    {
      "id": "uuid",
      "name": "–ö–∞—Ç–µ–≥–æ—Ä–∏—è",
      "items": []
    }
  ],
  "products": [
    {
      "id": "uuid",
      "name": "–ë–ª—é–¥–æ",
      "price": 100.00,
      "category": "uuid"
    }
  ]
}
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ .env**:
   ```env
   IIKO_API_KEY=e443a1d8f6f941eba3d92fbed30bdefd
   ```

2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**:
   ```bash
   php artisan iiko:test-connection
   ```

3. **–ü–æ–ª—É—á–∏—Ç–µ ID –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏** –∏–∑ –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã

4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –º–µ–Ω—é**:
   ```bash
   php artisan iiko:sync-menu your_organization_id
   ```

5. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∏–º–µ—Ä—ã –∏–∑ `IIKO_USAGE_EXAMPLES.md`

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏: `tail -f storage/logs/laravel.log | grep iiko`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `iiko:test-connection` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∫—ç—à —Ç–æ–∫–µ–Ω–æ–≤ –≤ Redis/Database

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ API –∫–ª—é—á–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å iiko API
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
